---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->



```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  # comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# enaho

```{r echo=FALSE}
library(enaho)

```

El paquete `enaho` permite descargar, leer y combinar bases del Instituto Nacional de Estadística e Informática (INEI) del Perú.



## Instalación

Puede instalar la versión desarrollador de `enaho` usando:

``` r
remotes::install_github("dopatendo/ILSAmerge")
```

## Identificar bases y módulos disponibles

Para identificar qué bases y módulos están disponibles, use `modulos.desc()`. 
Debe introducir qué encuesta quiere consultar (`"ENAHO"` o `"ENAHOpanel"`), y qué módulos. 
Si omite el nombre de la encuesta se usará `"ENAHO"`.
Si omite los módulos, se mostrarán todos los disponibles:


```{r }
modulos.desc(encuesta = "ENAHO")
```

También puede obtener los años para los que cada módulo está disponible usando 
`mostrarannos = TRUE`

```{r }
modulos.desc(encuesta = "ENAHO", modulos = c(29,32), mostrarannos = TRUE)
```

## Descargar bases

Para descargar bases use `descargar.inei()`. Tendrá que seleccionar un módulo con `modulo`;
los años que necesite con `annos`; el directorio de descarga con `dirdescarga`; y el período usando 
`"anual"`, `"t1"`, `"t2"`, `"t3"`, `"t4"`.

Por ejemplo, para descargar el módulo 37 del primer trimestre de 2011 en el directorio temporal:

```{r }
descargar.inei(encuesta = "ENAHO", modulo = 37, anno = 2011, tipo = "t1", dirdescarga = tempdir())
```

Note que una carpeta se habrá creado en el directorio:
```{r }
list.files(tempdir(),pattern = "enaho")
```

Dentro de esta carpeta se habrán descomprimido todos los archivos relacionados a ese período y módulo:
```{r }
list.files(file.path(tempdir(),"enaho_2011_Modulo37_t1"))
```

## Leer bases descargadas y combinarlas

Las bases descargads con `descargar.inei()` pueden ser leídas con `leer.inei()`. El módulo y los períodos deben ser especificados. Si más de una base es leída, la función producirá una lista. Por ejemplo, descargando también el segundo trimestre de 2011:

```{r }
descargar.inei(encuesta = "ENAHO", modulo = 37, annos = 2011, tipo = "t2", dirdescarga = tempdir())
```

Podemos leer ambos trimestres:
```{r }
leidas <- leer.inei(encuesta = "ENAHO", modulo = 37, annos = 2011, tipo = c("t1","t2"), directorio = tempdir())
leidas
```

Y, usando `combinar.inei()` (o el argumento `combinar` en `leer.inei`) podemos combinar ambos trimestres. También podemos especificar si sólo queremos combinar las variables comunes o todas las variables:
```{r }
combinar.inei(x = leidas, solocomunes = FALSE)
```

## Leer bases directamente desde la web

Usando `leer.inei.web()` podemos leer las bases directamente desde la web, aplicando las mismas reglas que `leer.inei()`:
```{r }
leer.inei.web(encuesta = "ENAHO", modulo = 37, annos = 2011, tipo = c("t1"))
```

